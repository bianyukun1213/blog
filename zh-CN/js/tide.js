"use strict";let clientCtx={};const clientCtxElement=document.querySelector('meta[name="tide-client-ctx"]');function getPageLang(){return document.documentElement.getAttribute("lang")}function isPageRtl(){return"rtl"===document.documentElement.getAttribute("dir")}clientCtxElement&&(clientCtx=JSON.parse(decodeURIComponent(clientCtxElement.getAttribute("content")))),document.addEventListener("error",(e=>{"img"===e.target.tagName.toLowerCase()&&(e.target.className+=" tide-broken-img")}),!0);class TideSettings{static#e="tide_settings";static version=1;static#t="SYSTEM";static get colorScheme(){return this.#t}static set colorScheme(e){"SYSTEM"!==e&&"LIGHT"!==e&&"DARK"!==e||(this.#t=e,this.#n())}static#o(){let e=localStorage.getItem(this.#e)??"{}";try{e=JSON.parse(e)}catch(t){e={}}clientUtils.isPlainObject(e)||(e={}),e=this.#d(e),this.colorScheme=e.colorScheme}static#d(e){return(!(e=clientUtils.deepClone(e)).version||e.version<1)&&(e.colorScheme="SYSTEM",e.version=1),e}static#n(){const e={version:this.version,colorScheme:this.colorScheme};localStorage.setItem(this.#e,JSON.stringify(e))}static{this.#o()}}function systemColorSchemeChanged(){TideSettings.colorScheme="SYSTEM",document.documentElement.removeAttribute("data-tide-color-scheme")}const darkModePreference=window.matchMedia("(prefers-color-scheme: dark)");darkModePreference.addEventListener("change",(e=>e.matches&&systemColorSchemeChanged()));const lightModePreference=window.matchMedia("(prefers-color-scheme: light)");function domContentLoadedHandler(e){const t=document.getElementById("tide-root"),n=[...document.querySelectorAll("#tide-sidebar a")],o=document.getElementById("tide-main-content"),d=[...document.getElementsByClassName("tide-btn-unmask-image")],i=document.getElementById("tide-btn-nav"),c=document.getElementById("tide-btn-search"),r=document.getElementById("tide-dialog-search"),a=document.getElementById("tide-btn-switch-color-scheme"),s=document.getElementById("tide-btn-settings"),l=document.getElementById("tide-btn-scroll-to-top"),m=document.getElementById("tide-btn-open-toc"),h=document.getElementById("tide-dialog-toc"),u=document.getElementById("tide-btn-switch-lang"),g=document.getElementById("tide-dialog-lang-picker");function S(e){if(e){t.setAttribute("data-tide-sidebar-expanded","true");for(const e of n)e.removeAttribute("tabindex")}else{t.setAttribute("data-tide-sidebar-expanded","false");for(const e of n)e.setAttribute("tabindex","-1")}}function E(){window.matchMedia("(min-width: 1280px)").matches?S(!0):S(!1)}for(const e of d)e.addEventListener("click",(function(e){e.target.parentElement.parentElement.nextElementSibling.setAttribute("data-unmasked","")}));window.addEventListener("resize",(()=>{E()})),E(),i.addEventListener("click",(function(e){"true"===t.getAttribute("data-tide-sidebar-expanded")?S(!1):S(!0)})),c&&c.addEventListener("click",(()=>{r.showModal()})),a.addEventListener("click",(function(e){let t;"light"===document.documentElement.getAttribute("data-tide-color-scheme")?t="LIGHT":"dark"===document.documentElement.getAttribute("data-tide-color-scheme")&&(t="DARK"),t||(t=darkModePreference.matches?"DARK":"LIGHT"),"LIGHT"===t?darkModePreference.matches?(TideSettings.colorScheme="SYSTEM",document.documentElement.removeAttribute("data-tide-color-scheme")):(TideSettings.colorScheme="DARK",document.documentElement.setAttribute("data-tide-color-scheme","dark")):"DARK"===t&&(lightModePreference.matches?(TideSettings.colorScheme="SYSTEM",document.documentElement.removeAttribute("data-tide-color-scheme")):(TideSettings.colorScheme="LIGHT",document.documentElement.setAttribute("data-tide-color-scheme","light")))})),s.addEventListener("click",(function(e){const t=document.getElementsByTagName("html")[0];isPageRtl()?t.setAttribute("dir","ltr"):t.setAttribute("dir","rtl")})),l.addEventListener("click",(()=>{o.scrollTo({top:0,behavior:"smooth"})})),m&&(m.addEventListener("click",(()=>{h.showModal()})),0===document.getElementsByClassName("tide-toc").length&&(m.style.display="none")),u&&u.addEventListener("click",(()=>{g.showModal()}))}lightModePreference.addEventListener("change",(e=>e.matches&&systemColorSchemeChanged())),"LIGHT"===TideSettings.colorScheme?document.documentElement.setAttribute("data-tide-color-scheme","light"):"DARK"===TideSettings.colorScheme&&document.documentElement.setAttribute("data-tide-color-scheme","dark"),"loading"!==document.readyState?domContentLoadedHandler():document.addEventListener("DOMContentLoaded",domContentLoadedHandler),window.addEventListener("hexo-blog-decrypt",(function(){window.location.hash.includes("tide-on-decryption-reload")?window.location.hash=window.location.hash.replace("tide-on-decryption-reload",""):(window.location.hash="tide-on-decryption-reload",window.location.reload())}));