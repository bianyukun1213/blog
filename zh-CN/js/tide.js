"use strict";let clientCtx={};const clientCtxElement=document.querySelector('meta[name="tide-client-ctx"]');function getPageLang(){return document.documentElement.getAttribute("lang")}function isPageRtl(){return"rtl"===document.documentElement.getAttribute("dir")}clientCtxElement&&(clientCtx=JSON.parse(decodeURIComponent(clientCtxElement.getAttribute("content"))));class TideSettings{static#e="tide_settings";static version=1;static#t="SYSTEM";static get colorScheme(){return this.#t}static set colorScheme(e){"SYSTEM"!==e&&"LIGHT"!==e&&"DARK"!==e||(this.#t=e,this.#n())}static#o(){let e=localStorage.getItem(this.#e)??"{}";try{e=JSON.parse(e)}catch(t){e={}}clientUtils.isPlainObject(e)||(e={}),e=this.#c(e),this.colorScheme=e.colorScheme}static#c(e){return(!(e=clientUtils.deepClone(e)).version||e.version<1)&&(e.colorScheme="SYSTEM",e.version=1),e}static#n(){const e={version:this.version,colorScheme:this.colorScheme};localStorage.setItem(this.#e,JSON.stringify(e))}static{this.#o()}}function systemColorSchemeChanged(){TideSettings.colorScheme="SYSTEM",document.documentElement.removeAttribute("tide-color-scheme")}const darkModePreference=window.matchMedia("(prefers-color-scheme: dark)");darkModePreference.addEventListener("change",(e=>e.matches&&systemColorSchemeChanged()));const lightModePreference=window.matchMedia("(prefers-color-scheme: light)");function domContentLoadedHandler(e){const t=document.getElementById("tide-root"),n=[...document.querySelectorAll("#tide-side-bar a")],o=document.getElementById("tide-main-content"),c=document.getElementById("tide-btn-nav"),i=document.getElementById("tide-btn-search"),d=document.getElementById("tide-dialog-search"),r=document.getElementById("tide-btn-switch-color-scheme"),s=document.getElementById("tide-btn-settings"),l=document.getElementById("tide-btn-scroll-to-top"),m=document.getElementById("tide-btn-open-toc"),a=document.getElementById("tide-dialog-toc"),h=document.getElementById("tide-btn-switch-lang"),u=document.getElementById("tide-dialog-lang-picker");function g(e,o=!1){if(e){t.setAttribute("tide-side-bar-expanded","true");for(const e of n)e.removeAttribute("tabindex")}else{t.setAttribute("tide-side-bar-expanded","false");for(const e of n)e.setAttribute("tabindex","-1")}}function S(){window.matchMedia("(min-width: 1280px)").matches?g(!0):g(!1)}i&&i.addEventListener("click",(()=>{d.showModal()})),r.addEventListener("click",(function(e){let t;"light"===document.documentElement.getAttribute("tide-color-scheme")?t="LIGHT":"dark"===document.documentElement.getAttribute("tide-color-scheme")&&(t="DARK"),t||(t=darkModePreference.matches?"DARK":"LIGHT"),"LIGHT"===t?darkModePreference.matches?(TideSettings.colorScheme="SYSTEM",document.documentElement.removeAttribute("tide-color-scheme")):(TideSettings.colorScheme="DARK",document.documentElement.setAttribute("tide-color-scheme","dark")):"DARK"===t&&(lightModePreference.matches?(TideSettings.colorScheme="SYSTEM",document.documentElement.removeAttribute("tide-color-scheme")):(TideSettings.colorScheme="LIGHT",document.documentElement.setAttribute("tide-color-scheme","light")))})),s.addEventListener("click",(function(e){const t=document.getElementsByTagName("html")[0];isPageRtl()?t.setAttribute("dir","ltr"):t.setAttribute("dir","rtl")})),window.addEventListener("resize",(()=>{S()})),S(),c.addEventListener("click",(function(e){"true"===t.getAttribute("tide-side-bar-expanded")?g(!1,!0):g(!0,!0)})),l.addEventListener("click",(()=>{o.scrollTo({top:0,behavior:"smooth"})})),m&&(m.addEventListener("click",(()=>{a.showModal()})),0===document.getElementsByClassName("tide-toc").length&&(m.style.display="none")),h&&h.addEventListener("click",(()=>{u.showModal()}))}lightModePreference.addEventListener("change",(e=>e.matches&&systemColorSchemeChanged())),"LIGHT"===TideSettings.colorScheme?document.documentElement.setAttribute("tide-color-scheme","light"):"DARK"===TideSettings.colorScheme&&document.documentElement.setAttribute("tide-color-scheme","dark"),"loading"!==document.readyState?domContentLoadedHandler():document.addEventListener("DOMContentLoaded",domContentLoadedHandler),window.addEventListener("hexo-blog-decrypt",(()=>{window.location.hash.includes("tide-on-decryption-reload")?window.location.hash=window.location.hash.replace("tide-on-decryption-reload",""):(window.location.hash="tide-on-decryption-reload",window.location.reload())}));