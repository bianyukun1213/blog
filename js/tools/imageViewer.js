export default function imageViewer(){let e=!1,t=1,n=!1,r=!1,s=0,a=0,o=0,i=0,l=0;const c=document.querySelector(".image-viewer-container"),d=c.querySelector("img"),m=e=>{document.body.style.overflow=e?"hidden":"auto",e?c.classList.add("active"):c.classList.remove("active")};let u=0;const v=e=>{n&&e.stopPropagation(),n=!1,d.style.cursor="grab"};d.addEventListener("wheel",(e=>{e.preventDefault();const n=d.getBoundingClientRect(),r=e.clientX-n.left,s=e.clientY-n.top,a=r-n.width/2,o=s-n.height/2,c=t;t+=-.001*e.deltaY,t=Math.min(Math.max(.8,t),4),c<t?(i-=a*(t-c),l-=o*(t-c)):(i=0,l=0),d.style.transform=`translate(${i}px, ${l}px) scale(${t})`}),{passive:!1}),d.addEventListener("mousedown",(e=>{e.preventDefault(),n=!0,a=e.clientX,o=e.clientY,d.style.cursor="grabbing"}),{passive:!1}),d.addEventListener("mousemove",(e=>{if(n){const n=(new Date).getTime();if(n-u<100)return;u=n;const s=e.clientX-a,c=e.clientY-o;i+=s,l+=c,a=e.clientX,o=e.clientY,d.style.transform=`translate(${i}px, ${l}px) scale(${t})`,r=!0}}),{passive:!1}),d.addEventListener("mouseup",v,{passive:!1}),d.addEventListener("mouseleave",v,{passive:!1}),c.addEventListener("click",(n=>{r||(e=!1,m(e),t=1,i=0,l=0,d.style.transform=`translate(${i}px, ${l}px) scale(${t})`),r=!1}));const p=document.querySelectorAll(".markdown-body img, .masonry-item img, #shuoshuo-content img"),y=n=>{"Escape"===n.key&&e&&(e=!1,m(e),t=1,i=0,l=0,d.style.transform=`translate(${i}px, ${l}px) scale(${t})`,document.removeEventListener("keydown",y))};p.forEach(((t,n)=>{t.addEventListener("click",(()=>{s=n,e=!0,m(e),d.src=t.src,document.addEventListener("keydown",y)}))}));document.addEventListener("keydown",(t=>{if(!e)return;if("ArrowUp"===t.key||"ArrowLeft"===t.key)s=(s-1+p.length)%p.length;else{if("ArrowDown"!==t.key&&"ArrowRight"!==t.key)return;s=(s+1)%p.length}const n=p[s];let r=n.src;n.hasAttribute("lazyload")&&(r=n.getAttribute("data-src"),n.src=r,n.removeAttribute("lazyload")),d.src=r})),!p.length&&c&&c.parentNode.removeChild(c)}