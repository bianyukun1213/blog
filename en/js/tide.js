"use strict";let clientCtx={};const clientCtxElement=document.querySelector('meta[name="tide-client-ctx"]');function getPageLang(){return document.documentElement.getAttribute("lang")}function isPageRtl(){return"rtl"===document.documentElement.getAttribute("dir")}clientCtxElement&&(clientCtx=JSON.parse(decodeURIComponent(clientCtxElement.getAttribute("content")))),document.addEventListener("error",(function(e){"img"===e.target.tagName.toLowerCase()&&(e.target.className+=" tide-broken-img")}),!0);class TideSettings{static#e="tide_settings";static version=1;static#t="SYSTEM";static get colorScheme(){return this.#t}static set colorScheme(e){"SYSTEM"!==e&&"LIGHT"!==e&&"DARK"!==e||(this.#t=e,this.#n())}static#d(){let e=localStorage.getItem(this.#e)??"{}";try{e=JSON.parse(e)}catch(t){e={}}clientUtils.isPlainObject(e)||(e={}),e=this.#o(e),this.colorScheme=e.colorScheme}static#o(e){return(!(e=clientUtils.deepClone(e)).version||e.version<1)&&(e.colorScheme="SYSTEM",e.version=1),e}static#n(){const e={version:this.version,colorScheme:this.colorScheme};localStorage.setItem(this.#e,JSON.stringify(e))}static{this.#d()}}function systemColorSchemeChanged(e){document.documentElement.dispatchEvent(new CustomEvent("colorschemechange",{detail:{newValue:e,alignedWithSystem:!0}}))}document.documentElement.addEventListener("colorschemechange",(function(e){e.detail.alignedWithSystem?(TideSettings.colorScheme="SYSTEM",delete document.documentElement.dataset.colorScheme):"dark"===e.detail.newValue?(TideSettings.colorScheme="DARK",document.documentElement.dataset.colorScheme="dark"):(TideSettings.colorScheme="LIGHT",document.documentElement.dataset.colorScheme="light")}));const darkModePreference=window.matchMedia("(prefers-color-scheme: dark)");darkModePreference.addEventListener("change",(e=>e.matches&&systemColorSchemeChanged("dark")));const lightModePreference=window.matchMedia("(prefers-color-scheme: light)");function handleForcedColorsChange(e){document.documentElement.dispatchEvent(new CustomEvent("forcedcolorschange",{detail:{active:e}}))}lightModePreference.addEventListener("change",(e=>e.matches&&systemColorSchemeChanged("light"))),"LIGHT"===TideSettings.colorScheme?document.documentElement.dispatchEvent(new CustomEvent("colorschemechange",{detail:{newValue:"light",alignedWithSystem:!1}})):"DARK"===TideSettings.colorScheme&&document.documentElement.dispatchEvent(new CustomEvent("colorschemechange",{detail:{newValue:"dark",alignedWithSystem:!1}})),document.documentElement.addEventListener("forcedcolorschange",(function(e){e.detail.active&&(TideSettings.colorScheme="SYSTEM",delete document.documentElement.dataset.colorScheme,darkModePreference.matches?document.documentElement.dispatchEvent(new CustomEvent("colorschemechange",{detail:{newValue:"dark",alignedWithSystem:!0}})):lightModePreference.matches&&document.documentElement.dispatchEvent(new CustomEvent("colorschemechange",{detail:{newValue:"light",alignedWithSystem:!0}})))}));const forcedColorsQuery=window.matchMedia("(forced-colors: active)");function domContentLoadedHandler(e){const t=document.getElementById("tide-root"),n=[...document.querySelectorAll("#tide-sidebar a")],d=document.getElementById("tide-main-content"),o=[...document.getElementsByClassName("tide-btn-unmask-image")],c=document.getElementById("tide-btn-nav"),i=document.getElementById("tide-btn-search"),a=document.getElementById("tide-dialog-search"),s=document.getElementById("tide-btn-color-scheme"),l=document.getElementById("tide-btn-settings"),m=document.getElementById("tide-floating-widgets"),r=document.getElementById("tide-btn-top"),h=document.getElementById("tide-btn-toc"),u=document.getElementById("tide-dialog-toc"),g=document.getElementById("tide-btn-langs"),E=document.getElementById("tide-dialog-lang-picker"),S=document.getElementById("tide-btn-interactions"),y=document.getElementById("tide-btn-extra-widgets");function v(e){if(e){t.dataset.sidebarExpanded="",c.setAttribute("aria-expanded","true");for(const e of n)e.removeAttribute("tabindex")}else{delete t.dataset.sidebarExpanded,c.setAttribute("aria-expanded","false");for(const e of n)e.setAttribute("tabindex","-1")}}function w(){window.matchMedia("(orientation: landscape) and (min-width: 1280px)").matches?v(!0):v(!1)}for(const e of o)e.addEventListener("click",(function(e){e.target.parentElement.parentElement.nextElementSibling.dataset.unmasked=""})),e.addEventListener("keydown",(function(e){if("Space"===e.code){e.preventDefault();e.target.parentElement.parentElement.nextElementSibling.dataset.unmasked=""}}));if(window.addEventListener("resize",(()=>{w()})),w(),c.addEventListener("click",(function(e){""===t.dataset.sidebarExpanded?v(!1):v(!0)})),i&&i.addEventListener("click",(()=>{a.showModal()})),s.addEventListener("click",(function(e){let t;"light"===document.documentElement.dataset.colorScheme?t="LIGHT":"dark"===document.documentElement.dataset.colorScheme&&(t="DARK"),t||(t=darkModePreference.matches?"DARK":"LIGHT"),"LIGHT"===t?darkModePreference.matches?document.documentElement.dispatchEvent(new CustomEvent("colorschemechange",{detail:{newValue:"dark",alignedWithSystem:!0}})):document.documentElement.dispatchEvent(new CustomEvent("colorschemechange",{detail:{newValue:"dark",alignedWithSystem:!1}})):"DARK"===t&&(lightModePreference.matches?document.documentElement.dispatchEvent(new CustomEvent("colorschemechange",{detail:{newValue:"light",alignedWithSystem:!0}})):document.documentElement.dispatchEvent(new CustomEvent("colorschemechange",{detail:{newValue:"light",alignedWithSystem:!1}})))})),l.addEventListener("click",(function(e){const t=document.getElementsByTagName("html")[0];isPageRtl()?t.setAttribute("dir","ltr"):t.setAttribute("dir","rtl")})),r.addEventListener("click",(()=>{d.scrollTo({top:0,behavior:"smooth"})})),h&&(h.addEventListener("click",(()=>{u.showModal()})),0===document.getElementsByClassName("tide-toc").length&&(h.style.display="none")),g&&g.addEventListener("click",(()=>{E.showModal()})),S){const e=document.getElementById("tide-page-interactions");S.addEventListener("click",(function(){e?document.getElementById("tide-main-content").scrollTo({top:e.offsetTop,behavior:"smooth"}):window.location.hash="tide-page-interactions"})),e||(S.style.display="none")}y.addEventListener("click",(function(){void 0===m.dataset.extraWidgets?m.dataset.extraWidgets="":delete m.dataset.extraWidgets})),h&&"none"!==h.style.display||g&&"none"!==g.style.display||S&&"none"!==S.style.display||(y.style.display="none")}forcedColorsQuery.addEventListener("change",(e=>handleForcedColorsChange(e.matches))),"loading"!==document.readyState?domContentLoadedHandler():document.addEventListener("DOMContentLoaded",domContentLoadedHandler),window.addEventListener("hexo-blog-decrypt",(function(){window.location.hash.includes("tide-on-decryption-reload")?window.location.hash=window.location.hash.replace("tide-on-decryption-reload",""):(window.location.hash="tide-on-decryption-reload",window.location.reload())}));